<# HEADY_BRAND:BEGIN
<# ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
<# ‚ïë  ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó                     ‚ïë
<# ‚ïë  ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù                     ‚ïë
<# ‚ïë  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                      ‚ïë
<# ‚ïë  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë  ‚ïö‚ñà‚ñà‚ïî‚ïù                       ‚ïë
<# ‚ïë  ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù   ‚ñà‚ñà‚ïë                        ‚ïë
<# ‚ïë  ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù    ‚ïö‚ïê‚ïù                        ‚ïë
<# ‚ïë                                                                  ‚ïë
<# ‚ïë  ‚àû SACRED GEOMETRY ‚àû  Organic Systems ¬∑ Breathing Interfaces    ‚ïë
<# ‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
<# ‚ïë  FILE: scripts/configure-pycharm.ps1                                                    ‚ïë
<# ‚ïë  LAYER: automation                                                  ‚ïë
<# ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
<# HEADY_BRAND:END
#>
# Heady JetBrains Extension Installer
# Simplified version focused on PyCharm configuration

param(
    [switch]$WhatIf
)

Write-Host "`nüíú JetBrains PyCharm Configuration" -ForegroundColor Magenta

# Check for PyCharm installation
$pycharmPaths = @(
    "C:\Users\JetBrains",
    "$env:ProgramFiles\JetBrains\PyCharm",
    "${env:ProgramFiles(x86)}\JetBrains\PyCharm",
    "$env:LOCALAPPDATA\JetBrains\PyCharm"
)

$foundPyCharm = $false
$pycharmPath = $null

foreach ($path in $pycharmPaths) {
    if (Test-Path $path) {
        if (Test-Path "$path\bin\pycharm64.exe") {
            $foundPyCharm = $true
            $pycharmPath = $path
            break
        }
    }
}

if (!$foundPyCharm) {
    Write-Host "‚ö†Ô∏è  PyCharm not found. Please install PyCharm first." -ForegroundColor Yellow
    return
}

Write-Host "  üì¶ Found PyCharm at: $pycharmPath" -ForegroundColor Green

# Get PyCharm version info
$productInfo = "$pycharmPath\product-info.json"
if (Test-Path $productInfo) {
    try {
        $info = Get-Content $productInfo | ConvertFrom-Json
        Write-Host "  üìã Version: $($info.version) (Build: $($info.buildNumber))" -ForegroundColor Cyan
    } catch {
        Write-Host "  ‚ö†Ô∏è  Could not read version info" -ForegroundColor Yellow
    }
}

# Essential plugins for PyCharm
$plugins = @(
    @{ Name = ".ignore"; Required = $true; Description = "Gitignore support" },
    @{ Name = "Rainbow Brackets"; Required = $false; Description = "Colorized brackets" },
    @{ Name = "GitToolBox"; Required = $false; Description = "Git enhancements" },
    @{ Name = "Key Promoter X"; Required = $false; Description = "Keyboard shortcuts" },
    @{ Name = "Python Enhanced"; Required = $false; Description = "Python improvements" }
)

Write-Host "`n  üîå Recommended Plugins:" -ForegroundColor Blue
foreach ($plugin in $plugins) {
    $status = if ($plugin.Required) { "REQUIRED" } else { "optional" }
    $color = if ($plugin.Required) { "Green" } else { "Gray" }
    Write-Host "    ‚îú‚îÄ [$status] $($plugin.Name)" -ForegroundColor $color
    Write-Host "    ‚îÇ   ‚îî‚îÄ $($plugin.Description)" -ForegroundColor DarkGray
}

Write-Host "`n  üõ†Ô∏è  Configuration Steps:" -ForegroundColor Yellow
Write-Host "    1. Open PyCharm" -ForegroundColor White
Write-Host "    2. Go to File ‚Üí Settings ‚Üí Plugins" -ForegroundColor White
Write-Host "    3. Install the plugins listed above" -ForegroundColor White
Write-Host "    4. Configure Python interpreter" -ForegroundColor White
Write-Host "    5. Enable Settings Sync for cross-device sync" -ForegroundColor White

Write-Host "`n  üêç Python Setup:" -ForegroundColor Green
Write-Host "    ‚Ä¢ Ensure Python 3.8+ is installed" -ForegroundColor White
Write-Host "    ‚Ä¢ Configure virtual environments" -ForegroundColor White
Write-Host "    ‚Ä¢ Set up code formatting (Black, isort)" -ForegroundColor White

Write-Host "`n  üîó Heady Integration:" -ForegroundColor Cyan
Write-Host "    ‚Ä¢ Install Heady Assistant plugin (when available)" -ForegroundColor White
Write-Host "    ‚Ä¢ Configure Heady project templates" -ForegroundColor White
Write-Host "    ‚Ä¢ Enable Heady code completion" -ForegroundColor White

if (!$WhatIf) {
    Write-Host "`n  ‚úÖ PyCharm configuration guide complete!" -ForegroundColor Green
    Write-Host "  üöÄ Next: Open PyCharm and follow the steps above" -ForegroundColor Yellow
} else {
    Write-Host "`n  üìù Configuration guide displayed (no changes made)" -ForegroundColor Cyan
}

Write-Host "`n  üí° Tip: Use PyCharm's Settings Sync to maintain configuration across devices" -ForegroundColor Cyan
